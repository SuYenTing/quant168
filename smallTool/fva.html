<html>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <script type='text/javascript' src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.1/knockout-min.js'></script>
</head>

    <body>
        <p>年金終值：表示每年(每月)收取或給付的錢，在經過一段期間後，所能累積的金額。</p>

        <p>金額：<input data-bind="value: textbox1" /></p>

        <p>期間：<input data-bind="value: textbox2" />    
            <input type="radio" name="flavorGroup" value="year" data-bind="checked: duringFlavor"  /> 年
            <input type="radio" name="flavorGroup" value="month" data-bind="checked: duringFlavor" /> 月 </p>

        <p>年利率：<input data-bind="value: textbox3" /></p>


        Output

        <p>年金現值：<strong data-bind="text: textbox6"></strong></p>





        <script type='text/javascript'>
            // This is a simple *viewmodel* - JavaScript that defines the data and behavior of your UI
            function AppViewModel() {


            //本金：textbox1
                this.textbox1 = ko.observable("30000");

                //存款期間：textbox2
                this.textbox2 = ko.observable("30");

                //年利率：textbox3
                this.textbox3 = ko.observable("1.05");

                //duringFlavor：textbox6
                this.duringFlavor = ko.observable("year");

                this.textbox6 = ko.computed(function() {
                    var p = this.textbox1()
                    var n = this.textbox2()
                    var i = this.textbox3() / 100
                    
                    if ( this.duringFlavor() == "year") {
                        var result=p * ((1 + i) ** n - 1) / i;
                        return result.toFixed(3);
                        //return result.toLocaleString('zh-TW', { style:'currency',currency: 'twd'});
                    } else { 
                        var j =  (1 + i) ** (1 / 12) - 1;
                        var result = p * ((1 + j) ^ n - 1) / j;
                        return result.toFixed(3);
                        //return result.toLocaleString('zh-TW', { style:'currency',currency: 'twd'});
                    }              
            }, this);
	
        }

        // Activates knockout.js
        ko.applyBindings(new AppViewModel());

        </script>
    </body>

</html>